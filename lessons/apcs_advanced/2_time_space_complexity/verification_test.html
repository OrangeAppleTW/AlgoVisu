<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¿®å¾©æ¸¬è©¦ - æ³¡æ³¡æ’åº</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
        }
        .success { border-color: #4CAF50; background-color: #f9fff9; }
        .error { border-color: #f44336; background-color: #fff9f9; }
        button {
            background: #333;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #555; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        #test-result { margin-top: 20px; font-family: monospace; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ æ³¡æ³¡æ’åºä¿®å¾©é©—è­‰</h1>
        
        <div class="test-section">
            <h3>1. åŸºæœ¬åŠŸèƒ½æ¸¬è©¦</h3>
            <p>æ¸¬è©¦é™£åˆ—ï¼š[4, 2, 7, 1, 3]ï¼ˆæ‡‰è©²åŸ·è¡Œ4è¼ªæ’åºï¼‰</p>
            <button onclick="testBasicFunction()">æ¸¬è©¦åŸºæœ¬åŠŸèƒ½</button>
            <div id="test-result"></div>
        </div>
        
        <div class="test-section">
            <h3>2. è¦–è¦ºåŒ–ç•Œé¢æ¸¬è©¦</h3>
            <p>æ¸¬è©¦å³å´çµ±è¨ˆé¢æ¿å’Œæ“ä½œè¨˜éŒ„åŠŸèƒ½</p>
            <button onclick="location.href='auto_demo.html'">é–‹å•Ÿå®Œæ•´æ¼”ç¤ºé é¢</button>
        </div>
        
        <div class="test-section">
            <h3>3. ä¿®å¾©å‰å¾Œå°æ¯”</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                    <h4>âŒ ä¿®å¾©å‰å•é¡Œ</h4>
                    <ul>
                        <li>æ’åºä¸æœƒåœæ­¢</li>
                        <li>è¼ªæ¬¡è¨ˆç®—éŒ¯èª¤</li>
                        <li>æ¯”è¼ƒé †åºä¸æ­£ç¢º</li>
                        <li>ç¼ºä¹ç›´è§€çš„æ•™å­¸çµ±è¨ˆ</li>
                    </ul>
                </div>
                <div>
                    <h4>âœ… ä¿®å¾©å¾ŒåŠŸèƒ½</h4>
                    <ul>
                        <li>æ­£ç¢ºçš„ 0~9, 0~8, ..., 0~1 é †åº</li>
                        <li>æº–ç¢ºçš„è¼ªæ¬¡å’Œæ­¥é©Ÿè¨ˆç®—</li>
                        <li>å¯¦æ™‚çµ±è¨ˆé¢æ¿</li>
                        <li>è©³ç´°æ“ä½œè¨˜éŒ„</li>
                        <li>ç†è«–å€¼èˆ‡å¯¦éš›å€¼å°æ¯”</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <script src="scripts/bubble_sort.js"></script>
    <script>
        function testBasicFunction() {
            const resultDiv = document.getElementById('test-result');
            resultDiv.innerHTML = '<h4>æ¸¬è©¦é€²è¡Œä¸­...</h4>';
            
            try {
                // å‰µå»ºæ¸¬è©¦ç”¨çš„è¦–è¦ºåŒ–å™¨
                const container = document.createElement('div');
                container.id = 'test-bubble-sort';
                container.style.display = 'none';
                document.body.appendChild(container);
                
                let stepLog = [];
                let passLog = [];
                
                const visualizer = new BubbleSortVisualizer('test-bubble-sort', {
                    onStep: (result) => {
                        if (result.action === 'compare') {
                            stepLog.push(`æ¯”è¼ƒ [${result.indices[0]}] å’Œ [${result.indices[1]}]: ${result.values[0]} vs ${result.values[1]}`);
                        } else if (result.action === 'swap') {
                            stepLog.push(`äº¤æ› [${result.indices[0]}] å’Œ [${result.indices[1]}]: ${result.values[1]} â†” ${result.values[0]}`);
                        } else if (result.action === 'pass_completed') {
                            passLog.push(`ç¬¬ ${result.pass} è¼ªå®Œæˆ`);
                        }
                    },
                    onComplete: (stats) => {
                        // æ¸¬è©¦å®Œæˆï¼Œé¡¯ç¤ºçµæœ
                        let resultHtml = '<h4>âœ… æ¸¬è©¦å®Œæˆï¼</h4>';
                        
                        resultHtml += `<p><strong>çµ±è¨ˆçµæœï¼š</strong></p>`;
                        resultHtml += `<ul>`;
                        resultHtml += `<li>ç¸½æ¯”è¼ƒæ¬¡æ•¸ï¼š${stats.comparisons}</li>`;
                        resultHtml += `<li>ç¸½äº¤æ›æ¬¡æ•¸ï¼š${stats.swaps}</li>`;
                        resultHtml += `<li>å®Œæˆè¼ªæ¬¡ï¼š${stats.passes}</li>`;
                        resultHtml += `<li>æ˜¯å¦å·²æ’åºï¼š${stats.isCompleted ? 'æ˜¯' : 'å¦'}</li>`;
                        resultHtml += `</ul>`;
                        
                        resultHtml += `<p><strong>è¼ªæ¬¡è¨˜éŒ„ï¼š</strong></p>`;
                        resultHtml += `<div style="background: #f0f0f0; padding: 10px; border-radius: 4px;">`;
                        passLog.forEach(log => {
                            resultHtml += `<div style="color: green; font-weight: bold;">${log}</div>`;
                        });
                        resultHtml += `</div>`;
                        
                        resultHtml += `<p><strong>æœ€çµ‚é™£åˆ—ï¼š</strong> [${stats.currentData.join(', ')}]</p>`;
                        
                        // é©—è­‰æ’åºæ˜¯å¦æ­£ç¢º
                        const isSorted = stats.currentData.every((val, i, arr) => 
                            i === 0 || arr[i-1] <= val
                        );
                        
                        if (isSorted && stats.isCompleted && stats.passes === 4) {
                            resultHtml += `<div style="color: green; font-weight: bold; font-size: 1.2em;">ğŸ‰ æ‰€æœ‰æ¸¬è©¦é€šéï¼</div>`;
                            resultDiv.innerHTML = resultHtml;
                            resultDiv.parentElement.className = 'test-section success';
                        } else {
                            resultHtml += `<div style="color: red; font-weight: bold;">âŒ æ¸¬è©¦å¤±æ•—</div>`;
                            resultDiv.innerHTML = resultHtml;
                            resultDiv.parentElement.className = 'test-section error';
                        }
                        
                        // æ¸…ç†æ¸¬è©¦å…ƒç´ 
                        document.body.removeChild(container);
                    }
                });
                
                // è¨­ç½®æ¸¬è©¦è³‡æ–™ä¸¦é–‹å§‹æ’åº
                const testData = [4, 2, 7, 1, 3];
                visualizer.setData(testData);
                visualizer.setSpeed(10); // å¿«é€ŸåŸ·è¡Œ
                visualizer.autoSort();
                
            } catch (error) {
                resultDiv.innerHTML = `<h4 style="color: red;">âŒ æ¸¬è©¦å¤±æ•—</h4><p>éŒ¯èª¤ï¼š${error.message}</p>`;
                resultDiv.parentElement.className = 'test-section error';
            }
        }
        
        // é é¢è¼‰å…¥æ™‚è‡ªå‹•åŸ·è¡Œæ¸¬è©¦
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                console.log('è‡ªå‹•åŸ·è¡ŒåŸºæœ¬åŠŸèƒ½æ¸¬è©¦...');
                testBasicFunction();
            }, 1000);
        });
    </script>
</body>
</html>