<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é–“è·èª¿æ•´æ¸¬è©¦</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background: #fafafa;
        }
        .test-container {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
        }
        button {
            background: #333;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 12px;
        }
        button:hover { background: #555; }
        h3 { margin-top: 0; color: #333; }
        h4 { color: #666; margin-bottom: 10px; }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 15px 0;
        }
        .before, .after {
            padding: 15px;
            border: 2px solid;
            border-radius: 6px;
        }
        .before {
            border-color: #ff6b6b;
            background: #fff5f5;
        }
        .after {
            border-color: #51cf66;
            background: #f3fff3;
        }
        .spacing-info {
            background: #e7f3ff;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“ é–“è·èª¿æ•´æ¸¬è©¦</h1>
        <p>æ¯”è¼ƒä¿®æ”¹å‰å¾Œé•·æ–¹é«”ä¹‹é–“çš„é–“è·è®ŠåŒ–</p>
        
        <div class="test-section">
            <h3>é–“è·èª¿æ•´å°æ¯”</h3>
            
            <div class="spacing-info">
                <strong>èª¿æ•´èªªæ˜ï¼š</strong>
                <ul>
                    <li><strong>ä¿®æ”¹å‰</strong>ï¼šå¯¬åº¦æ¯”ä¾‹è¼ƒå° (40%-60%)ï¼Œé–“è·è¼ƒå¤§ (40%-60%)</li>
                    <li><strong>ä¿®æ”¹å¾Œ</strong>ï¼šå¯¬åº¦æ¯”ä¾‹å¢åŠ  (60%-80%)ï¼Œé–“è·æ¸›å°‘ (20%-40%)</li>
                </ul>
            </div>
            
            <div class="test-container">
                <h4>8 å€‹å…ƒç´ æ¯”è¼ƒ</h4>
                <div class="comparison">
                    <div class="before">
                        <h5>âŒ ä¿®æ”¹å‰ (å¯¬åº¦50%, é–“è·50%)</h5>
                        <div id="before-8"></div>
                    </div>
                    <div class="after">
                        <h5>âœ… ä¿®æ”¹å¾Œ (å¯¬åº¦70%, é–“è·30%)</h5>
                        <div id="after-8"></div>
                    </div>
                </div>
                <button onclick="compare8Elements()">ğŸ”„ é‡æ–°æ¯”è¼ƒ 8 å€‹å…ƒç´ </button>
            </div>
            
            <div class="test-container">
                <h4>5 å€‹å…ƒç´ æ¯”è¼ƒ</h4>
                <div class="comparison">
                    <div class="before">
                        <h5>âŒ ä¿®æ”¹å‰ (å¯¬åº¦60%, é–“è·40%)</h5>
                        <div id="before-5"></div>
                    </div>
                    <div class="after">
                        <h5>âœ… ä¿®æ”¹å¾Œ (å¯¬åº¦80%, é–“è·20%)</h5>
                        <div id="after-5"></div>
                    </div>
                </div>
                <button onclick="compare5Elements()">ğŸ”„ é‡æ–°æ¯”è¼ƒ 5 å€‹å…ƒç´ </button>
            </div>
            
            <div class="test-container">
                <h4>12 å€‹å…ƒç´ æ¯”è¼ƒ</h4>
                <div class="comparison">
                    <div class="before">
                        <h5>âŒ ä¿®æ”¹å‰ (å¯¬åº¦40%, é–“è·60%)</h5>
                        <div id="before-12"></div>
                    </div>
                    <div class="after">
                        <h5>âœ… ä¿®æ”¹å¾Œ (å¯¬åº¦60%, é–“è·40%)</h5>
                        <div id="after-12"></div>
                    </div>
                </div>
                <button onclick="compare12Elements()">ğŸ”„ é‡æ–°æ¯”è¼ƒ 12 å€‹å…ƒç´ </button>
            </div>
        </div>
        
        <div class="test-section">
            <h3>é–“è·æ¯”ä¾‹å°æ¯”è¡¨</h3>
            <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                <thead>
                    <tr style="background: #333; color: white;">
                        <th style="padding: 12px; border: 1px solid #ddd;">å…ƒç´ æ•¸é‡</th>
                        <th style="padding: 12px; border: 1px solid #ddd;">ä¿®æ”¹å‰å¯¬åº¦</th>
                        <th style="padding: 12px; border: 1px solid #ddd;">ä¿®æ”¹å‰é–“è·</th>
                        <th style="padding: 12px; border: 1px solid #ddd;">ä¿®æ”¹å¾Œå¯¬åº¦</th>
                        <th style="padding: 12px; border: 1px solid #ddd;">ä¿®æ”¹å¾Œé–“è·</th>
                        <th style="padding: 12px; border: 1px solid #ddd;">é–“è·æ”¹å–„</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">â‰¤5 å€‹</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">60%</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">40%</td>
                        <td style="padding: 8px; border: 1px solid #ddd; background: #f3fff3;">80%</td>
                        <td style="padding: 8px; border: 1px solid #ddd; background: #f3fff3;">20%</td>
                        <td style="padding: 8px; border: 1px solid #ddd; color: green; font-weight: bold;">-50%</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">6-7 å€‹</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">55%</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">45%</td>
                        <td style="padding: 8px; border: 1px solid #ddd; background: #f3fff3;">75%</td>
                        <td style="padding: 8px; border: 1px solid #ddd; background: #f3fff3;">25%</td>
                        <td style="padding: 8px; border: 1px solid #ddd; color: green; font-weight: bold;">-44%</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">8-9 å€‹</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">50%</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">50%</td>
                        <td style="padding: 8px; border: 1px solid #ddd; background: #f3fff3;">70%</td>
                        <td style="padding: 8px; border: 1px solid #ddd; background: #f3fff3;">30%</td>
                        <td style="padding: 8px; border: 1px solid #ddd; color: green; font-weight: bold;">-40%</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">10-11 å€‹</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">45%</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">55%</td>
                        <td style="padding: 8px; border: 1px solid #ddd; background: #f3fff3;">65%</td>
                        <td style="padding: 8px; border: 1px solid #ddd; background: #f3fff3;">35%</td>
                        <td style="padding: 8px; border: 1px solid #ddd; color: green; font-weight: bold;">-36%</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">â‰¥12 å€‹</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">40%</td>
                        <td style="padding: 8px; border: 1px solid #ddd;">60%</td>
                        <td style="padding: 8px; border: 1px solid #ddd; background: #f3fff3;">60%</td>
                        <td style="padding: 8px; border: 1px solid #ddd; background: #f3fff3;">40%</td>
                        <td style="padding: 8px; border: 1px solid #ddd; color: green; font-weight: bold;">-33%</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="test-section">
            <h3>æ¸¬è©¦æ‰€æœ‰æƒ…æ³</h3>
            <button onclick="testAllCases()">ğŸš€ æ¸¬è©¦æ‰€æœ‰é–“è·èª¿æ•´</button>
            <button onclick="clearAll()">ğŸ—‘ï¸ æ¸…é™¤æ‰€æœ‰</button>
        </div>
    </div>
    
    <script src="scripts/bubble_sort.js"></script>
    <script>
        let visualizers = {};
        
        // èˆŠçš„å¯¬åº¦æ¯”ä¾‹è¨­å®š (æ¨¡æ“¬ä¿®æ”¹å‰)
        function createOldStyleVisualizer(containerId, elementCount) {
            let oldWidthRatio;
            if (elementCount >= 12) oldWidthRatio = 0.4;
            else if (elementCount >= 10) oldWidthRatio = 0.45;
            else if (elementCount >= 8) oldWidthRatio = 0.5;
            else if (elementCount >= 6) oldWidthRatio = 0.55;
            else oldWidthRatio = 0.6;
            
            // å‰µå»ºè‡ªå®šç¾©çš„èˆŠå¼è¦–è¦ºåŒ–å™¨
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            const svg = d3.select(container)
                .append('svg')
                .attr('width', 400)
                .attr('height', 150)
                .style('background-color', '#ffffff')
                .style('border', '1px solid #e0e0e0')
                .style('border-radius', '4px');
                
            const chartArea = svg.append('g')
                .attr('transform', 'translate(20, 20)');
            
            const data = Array.from({ length: elementCount }, (_, i) => i + 1);
            const chartWidth = 360;
            const chartHeight = 110;
            const maxValue = Math.max(...data);
            
            const barWidth = chartWidth / elementCount * oldWidthRatio;
            const barSpacing = chartWidth / elementCount * (1 - oldWidthRatio);
            
            const xScale = (i) => i * (barWidth + barSpacing) + barSpacing / 2;
            const yScale = d3.scaleLinear()
                .domain([0, maxValue])
                .range([chartHeight, 0]);
            
            const barGroups = chartArea.selectAll('.bar-group')
                .data(data)
                .enter()
                .append('g')
                .attr('class', 'bar-group')
                .attr('transform', (d, i) => `translate(${xScale(i)}, 0)`);
            
            barGroups.append('rect')
                .attr('class', 'bar')
                .attr('width', barWidth)
                .attr('height', (d) => chartHeight - yScale(d))
                .attr('y', (d) => yScale(d))
                .attr('fill', '#ffb3b3')
                .attr('stroke', '#888')
                .attr('stroke-width', 1)
                .attr('rx', 2)
                .attr('ry', 2);
            
            const fontSize = Math.max(8, Math.min(10, barWidth * 0.8));
            barGroups.append('text')
                .attr('x', barWidth / 2)
                .attr('y', (d) => yScale(d) - 3)
                .attr('text-anchor', 'middle')
                .attr('fill', '#333')
                .attr('font-family', 'monospace')
                .attr('font-size', `${fontSize}px`)
                .attr('font-weight', 'bold')
                .text((d) => d);
        }
        
        function compare8Elements() {
            createOldStyleVisualizer('before-8', 8);
            
            const visualizer = new BubbleSortVisualizer('after-8', {
                width: 400,
                height: 150
            });
            const data = [1, 2, 3, 4, 5, 6, 7, 8];
            visualizer.setData(data);
        }
        
        function compare5Elements() {
            createOldStyleVisualizer('before-5', 5);
            
            const visualizer = new BubbleSortVisualizer('after-5', {
                width: 400,
                height: 150
            });
            const data = [1, 2, 3, 4, 5];
            visualizer.setData(data);
        }
        
        function compare12Elements() {
            createOldStyleVisualizer('before-12', 12);
            
            const visualizer = new BubbleSortVisualizer('after-12', {
                width: 400,
                height: 150
            });
            const data = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12];
            visualizer.setData(data);
        }
        
        function testAllCases() {
            compare5Elements();
            compare8Elements();
            compare12Elements();
        }
        
        function clearAll() {
            ['before-5', 'after-5', 'before-8', 'after-8', 'before-12', 'after-12'].forEach(id => {
                document.getElementById(id).innerHTML = '';
            });
        }
        
        // é é¢è¼‰å…¥æ™‚è‡ªå‹•æ¸¬è©¦
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(testAllCases, 500);
        });
    </script>
</body>
</html>