<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¨¹ç‹€çµæ§‹é‚è¼¯ä¿®å¾©é©—è­‰</title>
    <link rel="stylesheet" href="focus-mode-styles.css">
</head>
<body>
    <div class="focus-container">
        <!-- å·¦å´ï¼šæ¨¹ç‹€åœ–è¦–è¦ºåŒ–å€åŸŸ -->
        <div class="tree-section">
            <h2 class="section-title">ğŸŒ³ çµ„åˆæœå°‹æ¨¹è¦–è¦ºåŒ– - é‚è¼¯ä¿®å¾©ç‰ˆ</h2>
            <div class="tree-visualization">
                <div id="combination-tree" class="tree-container">
                    <!-- æ¨¹ç‹€åœ–ç¯€é»æœƒåœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->
                </div>
            </div>
        </div>

        <!-- å³å´ï¼šæ§åˆ¶é¢æ¿ -->
        <div class="control-section">
            <h2 class="section-title">ğŸ”§ é‚Šé€£æ¥é‚è¼¯é©—è­‰</h2>
            
            <!-- ä¿®å¾©èªªæ˜ -->
            <div style="background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                <h4 style="margin: 0 0 10px 0; color: #856404;">ğŸš¨ ç™¼ç¾çš„å•é¡Œ</h4>
                <ul style="margin: 0; padding-left: 20px; color: #856404; font-size: 0.9em;">
                    <li>é‚Šçš„é€£æ¥é‚è¼¯ä¸å®Œæ•´</li>
                    <li>{1,2} çš„å·¦å­è‘‰éŒ¯èª¤é¡¯ç¤ºç‚º {3}</li>
                    <li>ç¼ºå°‘å¤šå€‹é‡è¦çš„é‚Šé€£æ¥</li>
                    <li>æ¨¹ç‹€çµæ§‹ä¸ç¬¦åˆçµ„åˆæšèˆ‰é‚è¼¯</li>
                </ul>
            </div>

            <!-- é æœŸçš„æ­£ç¢ºçµæ§‹ -->
            <div style="background: #d4edda; border: 2px solid #28a745; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                <h4 style="margin: 0 0 10px 0; color: #155724;">âœ… ä¿®å¾©å¾Œçš„æ­£ç¢ºçµæ§‹</h4>
                <div style="font-size: 0.85em; color: #155724; font-family: monospace;">
                    <div><strong>æ ¹ç¯€é» {} æ‡‰è©²é€£æ¥åˆ°ï¼š</strong></div>
                    <div>â”œâ”€ é¸æ“‡1 â†’ {1}</div>
                    <div>â””â”€ è·³é1 â†’ {}</div>
                    <br>
                    <div><strong>{1,2} æ‡‰è©²é€£æ¥åˆ°ï¼š</strong></div>
                    <div>â”œâ”€ é¸æ“‡3 â†’ <span style="background: #28a745; color: white; padding: 2px 4px; border-radius: 3px;">{1,2,3}</span></div>
                    <div>â””â”€ è·³é3 â†’ {1,2}</div>
                    <br>
                    <div><strong>æ‰€æœ‰ç¬¬2å±¤ç¯€é»éƒ½æ‡‰è©²æœ‰å®Œæ•´çš„å­ç¯€é»</strong></div>
                </div>
            </div>

            <!-- æª¢æŸ¥çµæœ -->
            <div id="verification-results" style="background: white; border-radius: 8px; padding: 15px; margin-top: 15px;">
                <h4 style="margin: 0 0 10px 0; color: #2c3e50;">æª¢æŸ¥çµæœ</h4>
                <div id="results-content">æ­£åœ¨æª¢æŸ¥é‚Šé€£æ¥...</div>
            </div>

            <!-- æ‰‹å‹•æª¢æŸ¥æŒ‰éˆ• -->
            <button onclick="checkTreeStructure()" style="width: 100%; padding: 12px; background: #007bff; color: white; border: none; border-radius: 8px; font-size: 1em; font-weight: bold; margin-top: 15px; cursor: pointer;">
                ğŸ” é‡æ–°æª¢æŸ¥æ¨¹ç‹€çµæ§‹
            </button>
        </div>
    </div>

    <!-- å¼•å…¥ç›¸é—œè…³æœ¬ -->
    <script src="combinations-tree.js"></script>
    
    <script>
        let treeVisualizer = null;
        
        function updateResult(message, type = 'info') {
            const resultsContent = document.getElementById('results-content');
            const color = type === 'success' ? '#28a745' : (type === 'error' ? '#dc3545' : '#007bff');
            resultsContent.innerHTML += `<div style="padding: 3px 0; color: ${color}; font-size: 0.9em;">${message}</div>`;
            resultsContent.scrollTop = resultsContent.scrollHeight;
        }

        function checkTreeStructure() {
            const resultsContent = document.getElementById('results-content');
            resultsContent.innerHTML = '';
            
            updateResult('ğŸš€ é–‹å§‹æª¢æŸ¥æ¨¹ç‹€çµæ§‹...', 'info');
            
            // æª¢æŸ¥é—œéµçš„é‚Šé€£æ¥
            const expectedEdges = [
                // æª¢æŸ¥ {1,2} çš„é€£æ¥
                { from: '1s_2s', to: '1s_2s_3s', description: '{1,2} â†’ {1,2,3} (é¸æ“‡3)' },
                { from: '1s_2s', to: '1s_2s_3n', description: '{1,2} â†’ {1,2} (è·³é3)' },
                
                // æª¢æŸ¥ {1} çš„é€£æ¥
                { from: '1s_2n', to: '1s_2n_3s', description: '{1} â†’ {1,3} (é¸æ“‡3)' },
                { from: '1s_2n', to: '1s_2n_3n', description: '{1} â†’ {1} (è·³é3)' },
                
                // æª¢æŸ¥ {2} çš„é€£æ¥
                { from: '1n_2s', to: '1n_2s_3s', description: '{2} â†’ {2,3} (é¸æ“‡3)' },
                { from: '1n_2s', to: '1n_2s_3n', description: '{2} â†’ {2} (è·³é3)' },
                
                // æª¢æŸ¥ {} çš„é€£æ¥
                { from: '1n_2n', to: '1n_2n_3s', description: '{} â†’ {3} (é¸æ“‡3)' },
                { from: '1n_2n', to: '1n_2n_3n', description: '{} â†’ {} (è·³é3)' }
            ];
            
            let passedChecks = 0;
            let totalChecks = expectedEdges.length;
            
            expectedEdges.forEach(expected => {
                const edgeId = `edge-${expected.from}-${expected.to}`;
                const edge = document.getElementById(edgeId);
                
                if (edge) {
                    updateResult(`âœ… ${expected.description}`, 'success');
                    passedChecks++;
                } else {
                    updateResult(`âŒ ç¼ºå¤±: ${expected.description}`, 'error');
                }
            });
            
            // æª¢æŸ¥ç¯€é»å…§å®¹
            const nodeChecks = [
                { id: 'node-1s_2s', expected: '{1,2}', description: 'ç¬¬2å±¤å·¦å´ç¯€é»' },
                { id: 'node-1s_2s_3s', expected: '{1,2,3}', description: '{1,2} çš„å·¦å­ç¯€é»' },
                { id: 'node-1s_2s_3n', expected: '{1,2}', description: '{1,2} çš„å³å­ç¯€é»' }
            ];
            
            updateResult('ğŸ“‹ æª¢æŸ¥ç¯€é»å…§å®¹...', 'info');
            nodeChecks.forEach(check => {
                const node = document.getElementById(check.id);
                if (node) {
                    const content = node.textContent;
                    if (content === check.expected) {
                        updateResult(`âœ… ${check.description}: ${content}`, 'success');
                        passedChecks++;
                    } else {
                        updateResult(`âŒ ${check.description}: æœŸæœ› ${check.expected}, å¯¦éš› ${content}`, 'error');
                    }
                } else {
                    updateResult(`âŒ ${check.description}: ç¯€é»ä¸å­˜åœ¨`, 'error');
                }
                totalChecks++;
            });
            
            // ç¸½çµ
            const successRate = ((passedChecks / totalChecks) * 100).toFixed(1);
            updateResult(`ğŸ“Š æª¢æŸ¥å®Œæˆ: ${passedChecks}/${totalChecks} é€šé (${successRate}%)`, 
                       passedChecks === totalChecks ? 'success' : 'error');
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            updateResult('ğŸš€ åˆå§‹åŒ–æ¨¹ç‹€åœ–è¦–è¦ºåŒ–å™¨...', 'info');
            
            try {
                // å‰µå»ºæ¸¬è©¦ç”¨çš„çˆ¶é¡æ¨¡æ“¬
                const mockParent = {
                    combinationTree: document.getElementById('combination-tree'),
                    elements: [1, 2, 3],
                    m: 2,
                    treeNodes: {},
                    treeEdges: []
                };
                
                // å‰µå»ºæ¨¹ç‹€åœ–è¦–è¦ºåŒ–å™¨
                treeVisualizer = new CombinationTreeVisualizer(mockParent);
                updateResult('âœ… æ¨¹ç‹€åœ–è¦–è¦ºåŒ–å™¨å‰µå»ºæˆåŠŸ', 'success');
                
                // å‰µå»ºæ¨¹ç‹€çµæ§‹
                treeVisualizer.createTreeStructure();
                updateResult('âœ… æ¨¹ç‹€åœ–çµæ§‹å‰µå»ºæˆåŠŸ', 'success');
                
                // å»¶é²åŸ·è¡Œæª¢æŸ¥ï¼Œç­‰å¾…DOMæ¸²æŸ“
                setTimeout(checkTreeStructure, 500);
                
            } catch (error) {
                updateResult(`âŒ åˆå§‹åŒ–å¤±æ•—: ${error.message}`, 'error');
            }
        });
    </script>
</body>
</html>