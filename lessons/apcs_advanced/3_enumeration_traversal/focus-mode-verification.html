<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ˆæ³¨æ¨¡å¼ä¿®å¾©é©—è­‰ - åœ–ä¾‹ç§»é™¤èˆ‡æ¨¹çµæ§‹ä¿®æ­£</title>
    <link rel="stylesheet" href="focus-mode-styles.css">
</head>
<body>
    <div class="focus-container">
        <!-- å·¦å´ï¼šæ¨¹ç‹€åœ–è¦–è¦ºåŒ–å€åŸŸ -->
        <div class="tree-section">
            <h2 class="section-title">ğŸŒ³ çµ„åˆæœå°‹æ¨¹è¦–è¦ºåŒ–</h2>
            <div class="tree-visualization">
                <div id="combination-tree" class="tree-container">
                    <!-- æ¨¹ç‹€åœ–ç¯€é»æœƒåœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->
                </div>
            </div>
        </div>

        <!-- å³å´ï¼šæ§åˆ¶é¢æ¿ -->
        <div class="control-section">
            <h2 class="section-title">ğŸ® æ§åˆ¶é¢æ¿</h2>
            
            <!-- å•é¡Œè¨­ç½® -->
            <div class="problem-setup">
                <div class="setup-row">
                    <span>å¾é›†åˆé¸æ“‡ï¼š</span>
                    <div class="elements-display">
                        <div class="element-item">1</div>
                        <div class="element-item">2</div>
                        <div class="element-item">3</div>
                    </div>
                </div>
                <div class="setup-row">
                    <span>é¸æ“‡æ•¸é‡ï¼š</span>
                    <select id="m-selector" class="m-selector">
                        <option value="2" selected>2</option>
                        <option value="1">1</option>
                        <option value="3">3</option>
                    </select>
                    <span id="combination-formula">C(3,2) = 3</span>
                </div>
            </div>

            <!-- æ¸¬è©¦æª¢æŸ¥åˆ—è¡¨ -->
            <div style="background: #e8f4fd; border: 2px solid #3498db; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                <h4 style="margin: 0 0 10px 0; color: #2c3e50;">ğŸ”§ ä¿®å¾©é©—è­‰é …ç›®</h4>
                <ul style="margin: 0; padding-left: 20px; color: #2c3e50; font-size: 0.9em;">
                    <li id="check-legend">â³ æª¢æŸ¥åœ–ä¾‹æ˜¯å¦å·²ç§»é™¤</li>
                    <li id="check-formula">â³ æª¢æŸ¥å…¬å¼é¡¯ç¤ºæ˜¯å¦ç‚º C(3,2)</li>
                    <li id="check-tree-logic">â³ æª¢æŸ¥æ¨¹çµæ§‹ï¼š{1,2} â†’ {1,2,3}</li>
                    <li id="check-valid-combinations">â³ æª¢æŸ¥æœ‰æ•ˆçµ„åˆæ¨™è¨˜</li>
                </ul>
            </div>

            <!-- çµ„åˆé‚è¼¯èªªæ˜ -->
            <div style="background: #f0f8f0; border: 2px solid #27ae60; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                <h4 style="margin: 0 0 10px 0; color: #2c3e50;">ğŸ“š çµ„åˆæšèˆ‰é‚è¼¯</h4>
                <div style="font-size: 0.9em; color: #2c3e50;">
                    <p><strong>ç›®æ¨™ï¼š</strong>å¾ {1,2,3} ä¸­é¸æ“‡ 2 å€‹å…ƒç´ </p>
                    <p><strong>æœ‰æ•ˆçµ„åˆï¼š</strong>{1,2}, {1,3}, {2,3}</p>
                    <p><strong>æ¨¹çµæ§‹é©—è­‰ï¼š</strong></p>
                    <ul style="margin: 5px 0; padding-left: 20px;">
                        <li>{1,2} çš„å·¦å­è‘‰æ‡‰è©²æ˜¯ {1,2,3} (é¸æ“‡3)</li>
                        <li>{1,2} çš„å³å­è‘‰æ‡‰è©²æ˜¯ {1,2} (è·³é3)</li>
                    </ul>
                </div>
            </div>

            <!-- æª¢æŸ¥çµæœé¡¯ç¤º -->
            <div id="test-results" style="background: white; border-radius: 8px; padding: 15px; margin-top: 15px;">
                <h4 style="margin: 0 0 10px 0; color: #2c3e50;">æª¢æŸ¥çµæœ</h4>
                <div id="results-content">æº–å‚™é–‹å§‹æª¢æŸ¥...</div>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥ç›¸é—œè…³æœ¬ -->
    <script src="combinations-core.js"></script>
    <script src="combinations-tree.js"></script>
    
    <script>
        console.log('ğŸ§ª å°ˆæ³¨æ¨¡å¼ä¿®å¾©é©—è­‰é–‹å§‹...');
        
        document.addEventListener('DOMContentLoaded', function() {
            const resultsContent = document.getElementById('results-content');
            const checkItems = {
                legend: document.getElementById('check-legend'),
                formula: document.getElementById('check-formula'),
                treeLogic: document.getElementById('check-tree-logic'),
                validCombinations: document.getElementById('check-valid-combinations')
            };
            
            function updateResult(message) {
                resultsContent.innerHTML += `<div style="padding: 3px 0; font-size: 0.9em;">${message}</div>`;
                resultsContent.scrollTop = resultsContent.scrollHeight;
            }
            
            function updateCheckItem(item, status, text) {
                if (item) {
                    item.textContent = `${status} ${text}`;
                    item.style.color = status === 'âœ…' ? '#27ae60' : (status === 'âŒ' ? '#e74c3c' : '#f39c12');
                }
            }
            
            try {
                // å‰µå»ºæ¸¬è©¦ç”¨çš„çˆ¶é¡æ¨¡æ“¬
                const mockParent = {
                    combinationTree: document.getElementById('combination-tree'),
                    elements: [1, 2, 3],
                    m: 2,
                    treeNodes: {},
                    treeEdges: []
                };
                
                updateResult('ğŸš€ é–‹å§‹å‰µå»ºæ¨¹ç‹€åœ–...');
                
                // å‰µå»ºæ¨¹ç‹€åœ–è¦–è¦ºåŒ–å™¨
                const treeVisualizer = new CombinationTreeVisualizer(mockParent);
                updateResult('âœ… æ¨¹ç‹€åœ–è¦–è¦ºåŒ–å™¨å‰µå»ºæˆåŠŸ');
                
                // å‰µå»ºæ¨¹ç‹€çµæ§‹
                treeVisualizer.createTreeStructure();
                updateResult('âœ… æ¨¹ç‹€åœ–çµæ§‹å‰µå»ºæˆåŠŸ');
                
                // ç­‰å¾…DOMæ¸²æŸ“å®Œæˆå¾Œé€²è¡Œæª¢æŸ¥
                setTimeout(() => {
                    updateResult('ğŸ” é–‹å§‹é€²è¡Œä¿®å¾©é©—è­‰...');
                    
                    // 1. æª¢æŸ¥åœ–ä¾‹æ˜¯å¦å·²ç§»é™¤
                    const legend = document.querySelector('.tree-legend');
                    if (!legend) {
                        updateCheckItem(checkItems.legend, 'âœ…', 'åœ–ä¾‹å·²æˆåŠŸç§»é™¤');
                        updateResult('âœ… åœ–ä¾‹æª¢æŸ¥ï¼šå·¦ä¸‹è§’é¡è‰²æç¤ºå·²ç§»é™¤');
                    } else {
                        updateCheckItem(checkItems.legend, 'âŒ', 'åœ–ä¾‹ä»ç„¶å­˜åœ¨');
                        updateResult('âŒ åœ–ä¾‹æª¢æŸ¥ï¼šåœ–ä¾‹ä»ç„¶å­˜åœ¨');
                    }
                    
                    // 2. æª¢æŸ¥å…¬å¼é¡¯ç¤º
                    const formula = document.getElementById('combination-formula');
                    if (formula && formula.textContent.includes('C(3,2)')) {
                        updateCheckItem(checkItems.formula, 'âœ…', 'å…¬å¼é¡¯ç¤ºæ­£ç¢ºï¼šC(3,2)');
                        updateResult(`âœ… å…¬å¼æª¢æŸ¥ï¼š${formula.textContent}`);
                    } else {
                        updateCheckItem(checkItems.formula, 'âŒ', 'å…¬å¼é¡¯ç¤ºéŒ¯èª¤');
                        updateResult(`âŒ å…¬å¼æª¢æŸ¥ï¼š${formula ? formula.textContent : 'æœªæ‰¾åˆ°'}`);
                    }
                    
                    // 3. æª¢æŸ¥æ¨¹çµæ§‹é‚è¼¯ï¼š{1,2} çš„å·¦å­è‘‰æ˜¯å¦ç‚º {1,2,3}
                    const node_1s_2s = document.getElementById('node-1s_2s'); // {1,2} ç¯€é»
                    const node_1s_2s_3s = document.getElementById('node-1s_2s_3s'); // {1,2,3} ç¯€é»
                    
                    if (node_1s_2s && node_1s_2s_3s) {
                        const parent_content = node_1s_2s.textContent;
                        const child_content = node_1s_2s_3s.textContent;
                        
                        if (parent_content === '{1,2}' && child_content === '{1,2,3}') {
                            updateCheckItem(checkItems.treeLogic, 'âœ…', 'æ¨¹çµæ§‹é‚è¼¯æ­£ç¢º');
                            updateResult(`âœ… æ¨¹çµæ§‹æª¢æŸ¥ï¼š${parent_content} â†’ ${child_content}`);
                        } else {
                            updateCheckItem(checkItems.treeLogic, 'âŒ', 'æ¨¹çµæ§‹é‚è¼¯éŒ¯èª¤');
                            updateResult(`âŒ æ¨¹çµæ§‹æª¢æŸ¥ï¼š${parent_content} â†’ ${child_content}`);
                        }
                    } else {
                        updateCheckItem(checkItems.treeLogic, 'âŒ', 'ç„¡æ³•æ‰¾åˆ°ç›¸é—œç¯€é»');
                        updateResult('âŒ æ¨¹çµæ§‹æª¢æŸ¥ï¼šç„¡æ³•æ‰¾åˆ°ç›¸é—œç¯€é»');
                    }
                    
                    // 4. æª¢æŸ¥æœ‰æ•ˆçµ„åˆæ¨™è¨˜ (é•·åº¦ç‚º2çš„çµ„åˆæ‡‰è©²æ¨™è¨˜ç‚ºæœ‰æ•ˆ)
                    const validCombinations = ['{1,2}', '{1,3}', '{2,3}'];
                    let validCount = 0;
                    
                    validCombinations.forEach(combo => {
                        const nodes = Array.from(document.querySelectorAll('.tree-node')).filter(node => 
                            node.textContent === combo
                        );
                        
                        if (nodes.length > 0) {
                            const hasValidClass = nodes.some(node => node.classList.contains('solution'));
                            if (hasValidClass) {
                                validCount++;
                                updateResult(`âœ… æœ‰æ•ˆçµ„åˆæ¨™è¨˜ï¼š${combo}`);
                            } else {
                                updateResult(`âš ï¸ æœ‰æ•ˆçµ„åˆæ¨™è¨˜ï¼š${combo} æœªæ­£ç¢ºæ¨™è¨˜`);
                            }
                        }
                    });
                    
                    if (validCount === 3) {
                        updateCheckItem(checkItems.validCombinations, 'âœ…', 'æ‰€æœ‰æœ‰æ•ˆçµ„åˆå·²æ­£ç¢ºæ¨™è¨˜');
                    } else {
                        updateCheckItem(checkItems.validCombinations, 'âš ï¸', `${validCount}/3 å€‹çµ„åˆæ¨™è¨˜æ­£ç¢º`);
                    }
                    
                    // ç¸½çµ
                    updateResult('ğŸ“Š é©—è­‰å®Œæˆï¼');
                    
                }, 500);
                
            } catch (error) {
                console.error('âŒ é©—è­‰å¤±æ•—:', error);
                updateResult(`âŒ é©—è­‰å¤±æ•—: ${error.message}`);
            }
        });
    </script>
</body>
</html>